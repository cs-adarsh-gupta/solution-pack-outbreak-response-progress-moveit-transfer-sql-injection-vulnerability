[
  {
    "products": {
      "fortigate": [
        {
          "product_name": "FortiGate",
          "remediation": {
            "type": "package",
            "packages": [
              {
                "service": "ips",
                "service_name": "IPS",
                "description": "Blocks exploitation of the Log4j2 vulnerability",
                "kill_chain": {
                  "step": "Exploitation"
                },
                "link": "https://www.fortiguard.com/updates/ips?version=19.231",
                "minimum_version": "19.231"
              }
            ]
          },
          "detection": {
            "attackid": [
              51006,
              51050,
              51060
            ]
          }
        }
      ],
      "fortiweb": [
        {
          "product_name": "FortiWeb",
          "remediation": {
            "type": "package",
            "packages": [
              {
                "service": "waf",
                "service_name": "Web App Security",
                "description": "Blocks exploitation of the Log4j2 vulnerability",
                "kill_chain": {
                  "step": "Exploitation"
                },
                "link": "https://www.fortiguard.com/updates/websecurity?version=0.00308",
                "minimum_version": "0.00308"
              }
            ]
          },
          "detection": {
            "signature_id": [
              "090490119",
              "090490120",
              "090490121",
              "090490122"
            ]
          }
        }
      ],
      "forticlient": [
        {
          "product_name": "FortiClient",
          "remediation": {
            "type": "package",
            "packages": [
              {
                "service": "vuln",
                "service_name": "Vulnerability",
                "description": "Detects presence of Log4j2 vulnerability on Linux machines",
                "kill_chain": {
                  "step": "Delivery"
                },
                "link": "https://www.fortiguard.com/updates/epvuln?version=2.087&os=Linux",
                "minimum_version": "2.087"
              }
            ]
          },
          "detection": {
            "vulnid": [
              70935
            ]
          }
        },
        {
          "product_name": "FortiClient",
          "remediation": {
            "type": "package",
            "packages": [
              {
                "service": "app-fw",
                "service_name": "Application Firewall",
                "description": "Blocks exploitation of the Log4j2 vulnerability",
                "kill_chain": {
                  "step": "Exploitation"
                },
                "link": "https://www.fortiguard.com/updates/ips?version=19.231",
                "minimum_version": "19.231"
              }
            ]
          },
          "detection": {
            "utmevent": [
              51006,
              51050,
              51060
            ]
          }
        },
        {
          "product_name": "FortiClient",
          "remediation": {
            "type": "upgrade",
            "upgrade_to": [
              "6.2+"
            ],
            "packages": [
              {
                "service": "threat-hunting",
                "service_name": "Threat Hunting",
                "kill_chain": {
                  "step": "SIEM/SOAR"
                },
                "link": "https://community.fortinet.com/t5/FortiClient/Technical-Tip-Using-FortiClient-to-protect-against-Apache-Log4j/ta-p/201061"
              }
            ]
          }
        }
      ],
      "fortiedr": [
        {
          "product_name": "FortiEDR",
          "remediation": {
            "type": "upgrade",
            "upgrade_to": [
              "5.0+"
            ],
            "packages": [
              {
                "service": "edr-post",
                "service_name": "Post-execution",
                "description": "Detects post-exploitation behavior associated with the Log4j2 vulnerability.",
                "kill_chain": {
                  "step": "Installation"
                },
                "link": "https://community.fortinet.com/t5/FortiEDR/Technical-Tip-How-FortiEDR-protects-against-the-exploitation-of/ta-p/201027"
              }
            ]
          }
        },
        {
          "product_name": "FortiEDR",
          "remediation": {
            "type": "upgrade",
            "upgrade_to": [
              "5.0+"
            ],
            "packages": [
              {
                "service": "threat-hunting",
                "service_name": "Threat Hunting",
                "description": "Threat hunting for vulnerable jar files pertaining to the Log4j2 vulnerability",
                "kill_chain": {
                  "step": "SIEM/SOAR"
                },
                "link": "https://community.fortinet.com/t5/FortiEDR/Technical-Tip-How-FortiEDR-protects-against-the-exploitation-of/ta-p/201027"
              }
            ]
          }
        }
      ],
      "fortisase": [
        {
          "product_name": "FortiSASE",
          "remediation": {
            "type": "package",
            "packages": [
              {
                "service": "ips",
                "service_name": "IPS",
                "description": "Blocks exploitation of the Log4j2 vulnerability",
                "kill_chain": {
                  "step": "Exploitation"
                },
                "link": "https://www.fortiguard.com/updates/ips?version=19.231",
                "minimum_version": "19.231"
              }
            ]
          }
        }
      ],
      "fortindr": [
        {
          "product_name": "FortiNDR",
          "remediation": {
            "type": "package",
            "packages": [
              {
                "service": "ips",
                "service_name": "IPS",
                "description": "Blocks exploitation of the Log4j2 vulnerability",
                "kill_chain": {
                  "step": "Exploitation"
                },
                "link": "https://www.fortiguard.com/updates/ips?version=19.231",
                "minimum_version": "19.231"
              }
            ]
          }
        }
      ],
      "fortideceptor": [
        {
          "product_name": "FortiDeceptor",
          "remediation": {
            "type": "package",
            "packages": [
              {
                "service": "ips",
                "service_name": "Decoy VM",
                "description": "Detects activities related to the Log4j2 vulnerability",
                "kill_chain": {
                  "step": "Reconnaissance"
                },
                "link": "https://www.fortiguard.com/updates/odcs?version=20221105.00000",
                "minimum_version": "20221105"
              }
            ]
          }
        },
        {
          "product_name": "FortiDeceptor",
          "remediation": {
            "type": "upgrade",
            "upgrade_to": [
              "3.3+"
            ],
            "packages": [
              {
                "service": "threat-hunting",
                "service_name": "Threat Hunting",
                "description": "Detects activities related to the Log4j2 vulnerability",
                "kill_chain": {
                  "step": "SIEM/SOAR"
                },
                "link": "https://community.fortinet.com/t5/FortiDeceptor/Technical-Tip-How-to-use-FortiDeceptor-to-Detect-amp-Mitigate/ta-p/201741"
              }
            ]
          }
        }
      ],
      "forticwp": [
        {
          "product_name": "FortiCWP",
          "remediation": {
            "type": "package",
            "packages": [
              {
                "service": "vuln",
                "service_name": "Vulnerability",
                "description": "Protects CI/CD pipeline by detecting the presence of log4j2 vulnerability in container images",
                "kill_chain": {
                  "step": "Delivery"
                },
                "link": "https://community.fortinet.com/t5/FortiCWP/Technical-Tip-Using-FortiCWP-to-detect-presence-of-Apache-Log4j2/ta-p/201017",
                "minimum_version": "21.3.0"
              }
            ]
          }
        }
      ],
      "fortidevsec": [
        {
          "product_name": "FortiDevSec",
          "remediation": {
            "type": "package",
            "packages": [
              {
                "service": "vuln",
                "service_name": "Vulnerability",
                "description": "Detects Log4j2 vulnerability in web application source code and packages through SCA scans, and earlier in the development lifecycle of the application on the CI/CD pipeline",
                "kill_chain": {
                  "step": "Delivery"
                },
                "link": "https://community.fortinet.com/t5/FortiDevSec/Technical-Tip-Using-FortiDevSec-SCA-scanner-to-detect-and/ta-p/216282?emcs_t=S2h8ZW1haWx8dG9waWNfc3Vic2NyaXB0aW9ufEw0WlNRS09ZM09UM1VIfDIxNjI4MnxTVUJTQ1JJUFRJT05TfGhL",
                "minimum_version": "22.3"
              }
            ]
          }
        }
      ],
      "fortiadc": [
        {
          "product_name": "FortiADC",
          "remediation": {
            "type": "package",
            "packages": [
              {
                "service": "ips",
                "service_name": "IPS",
                "description": "Blocks exploitation of the Log4j2 vulnerability",
                "kill_chain": {
                  "step": "Exploitation"
                },
                "link": "https://www.fortiguard.com/updates/ips?version=19.231",
                "minimum_version": "19.231"
              }
            ]
          }
        },
        {
          "product_name": "FortiADC",
          "remediation": {
            "type": "package",
            "packages": [
              {
                "service": "waf",
                "service_name": "Web App Security",
                "description": "Blocks exploitation of the Log4j2 vulnerability",
                "kill_chain": {
                  "step": "Exploitation"
                },
                "link": "https://www.fortiguard.com/updates/fadc-waf?version=1.00030",
                "minimum_version": "1.00030"
              }
            ]
          },
          "detection": {
            "sigid": [
              1002017253
            ]
          }
        }
      ],
      "fortiproxy": [
        {
          "product_name": "FortiProxy",
          "remediation": {
            "type": "package",
            "packages": [
              {
                "service": "ips",
                "service_name": "IPS",
                "description": "Blocks exploitation of the Log4j2 vulnerability",
                "kill_chain": {
                  "step": "Exploitation"
                },
                "link": "https://www.fortiguard.com/updates/ips?version=19.231",
                "minimum_version": "19.231"
              }
            ]
          },
          "detection": {
            "attackid": [
              51006,
              51050,
              51060
            ]
          }
        }
      ],
      "fortianalyzer": [
        {
          "product_name": "FortiAnalyzer",
          "remediation": {
            "type": "package",
            "packages": [
              {
                "service": "outbreak-detect",
                "service_name": "Outbreak Detection",
                "description": "Automated detection of indicators for the Log4j2 vulnerability from across the security fabric",
                "kill_chain": {
                  "step": "SIEM/SOAR"
                },
                "link": "https://www.fortiguard.com/updates/outbreak-detection-service?version=1.00041",
                "minimum_version": "1.00041"
              }
            ]
          }
        },
        {
          "product_name": "FortiAnalyzer",
          "remediation": {
            "type": "upgrade",
            "upgrade_to": [
              "6.4+"
            ],
            "packages": [
              {
                "service": "threat-hunting",
                "service_name": "Threat Hunting",
                "description": "Threat hunting for indicators for the Log4j2 vulnerability from across the security fabric",
                "kill_chain": {
                  "step": "SIEM/SOAR"
                },
                "link": "https://community.fortinet.com/t5/FortiAnalyzer/Technical-Tip-Using-FortiAnalyzer-to-detect-activities-related/ta-p/201026"
              }
            ]
          }
        }
      ],
      "fortisiem": [
        {
          "product_name": "FortiSIEM",
          "remediation": {
            "type": "upgrade",
            "upgrade_to": [
              "6.0+"
            ],
            "packages": [
              {
                "service": "threat-hunting",
                "service_name": "Threat Hunting",
                "description": "Threat hunting for indicators for the Log4j2 vulnerability from across the security fabric and 3rd party products",
                "kill_chain": {
                  "step": "SIEM/SOAR"
                },
                "link": "https://community.fortinet.com/t5/FortiSIEM/Technical-Tip-How-to-use-FortiSIEM-to-detect-activities-related/ta-p/201082"
              }
            ]
          }
        }
      ]
    },
    "title": "Apache Log4j2 Vulnerability",
    "sub_title": "RCE and DoS in Apache Java logging library ",
    "link": "https://logging.apache.org/log4j/2.x/security.html",
    "cve_list": [
      "CVE-2021-44228",
      "CVE-2021-45046",
      "CVE-2021-45105",
      "CVE-2021-44832"
    ],
    "description": "A 0-day exploit was discovered on a popular Java library Log4j2 that can result to a Remote Code Execution (RCE). This is a widely deployed library, and while systems protected by Fortinet Security Fabric are secured by the protections below, all systems need to upgrade ASAP as this is 10.0 severity.  Due to the high visibility and attention, subsequent vulnerabilities have since emerged.",
    "threat_signal": "https://www.fortiguard.com/threat-signal-report/4335/apache-log4j-remote-code-execution-vulnerability-cve-2021-44228",
    "background": "The Log4j2 is a Java-based logging utility that is part of the Apache Software. For more details on the background please read Fortinet Blog: https://www.fortinet.com/blog/threat-research/critical-apache-log4j-log4shell-vulnerability-what-you-need-to-know\r\n\r\nTo view, Fortinet products impacted by this vulnerability, refer to:  https://www.fortiguard.com/psirt/FG-IR-21-245\r\n\r\nTechnical information pertaining to each vulnerability, please refer to the FortiGuard Threat Signals at:\r\nhttps://www.fortiguard.com/threat-signal-report/4335\r\nhttps://www.fortiguard.com/threat-signal-report/4339\r\nhttps://www.fortiguard.com/threat-signal-report/4345\r\nhttps://www.fortiguard.com/threat-signal-report/4360",
    "announced": "On Dec 9, a 0-day was posted on Twitter with a PoC posted in GitHub. On Dec 10, several security-related websites picked up the vulnerability and released an article.",
    "latest": "Jun 27, 2022:  Over 6 months later, stories of Log4j2 exploits continue to be published on near-daily basis and FortiGuard Labs continues to see active exploitation attempts.  On a single day (Jun 14, 2022), FortiGuard IPS blocked over 50,000 exploits. ",
    "tag": "Log4j2 Vulnerability",
    "event_handler_desc": "Event handler to detect triggers for the Log4j2 vulnerability across the fabric.",
    "mantis": "767727, 821294",
    "status": "LIVE,WEB",
    "additional_resources": [
      {
        "Source": "CISA Gov",
        "Link": "https://www.cisa.gov/uscert/ncas/current-activity/2021/12/13/cisa-creates-webpage-apache-log4j-vulnerability-cve-2021-44228"
      },
      {
        "Source": "US CERT",
        "Link": "https://www.cisa.gov/uscert/ncas/alerts/aa21-356a"
      },
      {
        "Source": "Apache",
        "Link": "https://logging.apache.org/log4j/2.x/security.html"
      },
      {
        "Source": "PSIRT",
        "Link": "https://www.fortiguard.com/psirt/FG-IR-21-245"
      },
      {
        "Source": "Threat Signal",
        "Link": "https://www.fortiguard.com/threat-signal-report/4335"
      }
    ],
    "outbreak_url": "https://www.fortiguard.com/outbreak-alert/log4j2-vulnerability"
  },
  {
    "protect": [
      {
        "name": "Protect",
        "Description": "Countermeasures across the security fabric for protecting assets, data and network from cybersecurity events:"
      }
    ],
    "detect": [
      {
        "name": "Detect",
        "Description": "Find and correlate important information to identify an outbreak, the following updates are available to raise alert and generate reports:"
      }
    ],
    "respond": [
      {
        "name": "Respond",
        "Description": "Develop containment techniques to mitigate impacts of security events:",
        "subgroup": {
          "name": "Automated Response",
          "Description": "Services that can automaticlly respond to this outbreak.",
          "list": [
            {
              "id": "fctforen",
              "name": "FortiClient Forensics",
              "link": "https://docs.fortinet.com/document/forticlient/7.0.0/new-features/343224/fortiguard-forensics-service-7-0-6"
            },
            {
              "id": "fctth",
              "name": "FortiClient Threat Hunting",
              "link": ""
            },
            {
              "id": "fxdr",
              "name": "FortiXDR",
              "link": "https://community.fortinet.com/t5/FortiEDR/Threat-Coverage-How-FortiEDR-protects-against-the-exploitation/ta-p/201027"
            },
            {
              "id": "soar",
              "name": "FortiSOAR",
              "link": ""
            }
          ]
        },
        "subgroup2": {
          "name": "Assisted Response Services",
          "Description": "Experts to assist you with analysis, containment and response activities.",
          "list": [
            {
              "id": "incresp",
              "name": "Incident Response",
              "link": "https://community.fortinet.com/t5/FortiGuard/Technical-Tip-Engaging-FortiGuard-Incident-Response-Services-to/ta-p/242956"
            },
            {
              "id": "freconaci",
              "name": "FortiRecon: ACI",
              "link": "https://community.fortinet.com/t5/FortiRecon/Outbreak-Alert-Apache-Log4j2-Remote-Code-Execution-Vulnerability/ta-p/230741"
            }
          ]
        }
      }
    ],
    "recover": [
      {
        "name": "Recover",
        "Description": "Improve security posture and processes by implementing security awareness and training, in preparation for (and recovery from) security incidents:",
        "subgroup": {
          "name": "InfoSec Services",
          "Description": "Security readiness and awareness training for SOC teams, InfoSec and general employees.",
          "list": [
            {
              "id": "respready",
              "name": "Response Readiness",
              "link": "https://www.fortinet.com/solutions/enterprise-midsize-business/security-as-a-service/incident-response-readiness"
            },
            {
              "id": "secaware",
              "name": "Security Awareness",
              "link": "https://www.fortinet.com/training/security-awareness-training"
            },
            {
              "id": "fphish",
              "name": "FortiPhish",
              "link": ""
            }
          ]
        }
      }
    ],
    "identify": [
      {
        "name": "Identify",
        "Description": "Identify processes and assets that need protection:",
        "subgroup": {
          "name": "Attack Surface Monitoring (Inside & Outside)",
          "Description": "Security reconnaissance and penetration testing services, covering both internal & external attack vectors, including those introduced internally via software supply chain.",
          "list": [
            {
              "id": "secrating",
              "name": "Security Rating",
              "link": "https://www.fortiguard.com/services/secr"
            },
            {
              "id": "freconeasm",
              "name": "FortiRecon: EASM",
              "link": "https://community.fortinet.com/t5/FortiRecon/Outbreak-Alert-Apache-Log4j2-Remote-Code-Execution-Vulnerability/ta-p/230741"
            },
            {
              "id": "freconbp",
              "name": "FortiRecon: BP",
              "link": ""
            },
            {
              "id": "fdevsec",
              "name": "FortiDevSec",
              "link": "https://community.fortinet.com/t5/FortiDevSec/Technical-Tip-Using-FortiDevSec-SCA-scanner-to-detect-and/ta-p/216282"
            },
            {
              "id": "fdast",
              "name": "FortiDAST",
              "link": "https://community.fortinet.com/t5/FortiDAST/Outbreak-Alert-Apache-Log4j2-Vulnerability/ta-p/243905"
            }
          ]
        }
      }
    ]
  }
]